<!doctype html>
<html>
<head>
	<title>To Do</title>
  <!-- build:css css/todo-app.css -->
  <link rel="stylesheet" type="text/css" href="/public/stylesheets/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="/public/stylesheets/style.css">
  <link rel="stylesheet" type="text/css" href="/bower_components/angular-loading-bar/build/loading-bar.css">
  <link rel="stylesheet" type="text/css" href="/bower_components/angular-xeditable/dist/css/xeditable.css">
  <link rel="stylesheet" type="text/css" href="/public/stylesheets/chat.css">
  <!-- endbuild -->

  <!-- build:js js/todo-app.js -->
  <script type="text/javascript" src="/bower_components/jquery/dist/jquery.js"></script>
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
  
  <script type="text/javascript" src="/bower_components/bootstrap/dist/js/bootstrap.js"></script>
  <script type="text/javascript" src="/bower_components/angular/angular.js"></script>
  <script type="text/javascript" src="/bower_components/angular-resource/angular-resource.js"></script>
  <script type="text/javascript" src="/bower_components/angular-ui-router/release/angular-ui-router.js"></script>
  <script type="text/javascript" src="/bower_components/angular-local-storage/dist/angular-local-storage.js"></script>
  <script type="text/javascript" src="/bower_components/angular-translate/angular-translate.js"></script>
   <script type="text/javascript" src="/bower_components/angular-translate-loader-static-files/angular-translate-loader-static-files.js"></script> 
  <script type="text/javascript" src="/bower_components/angular-loading-bar/build/loading-bar.js"></script>
  <script type="text/javascript" src="/bower_components/angular-xeditable/dist/js/xeditable.js"></script>
  <script type="text/javascript" src="/public/javascripts/elevator.js"></script>
  <script type="text/javascript" src="/public/javascripts/app.js"></script>
  <script type="text/javascript" src="/public/javascripts/controllers.js"></script>
  <script type="text/javascript" src="/public/javascripts/services.js"></script>
  <script type="text/javascript" src="/public/javascripts/factories.js"></script>
  <script type="text/javascript" src="/public/javascripts/directives.js"></script>
  <script type="text/javascript" src="/public/javascripts/states.js"></script>
  <!-- endbuild -->
	
	
</head>
<body data-ng-app="ToDoApp">
  <data-ng-if="globals.isAuthenticated">
    <data-to-do-heart-beat data-config="globals.heartBeatConfig">
  </data-ng-if>
	<nav data-ng-controller="NavbarController" class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-2">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a data-ng-if="!globals.isAuthenticated" class="navbar-brand" data-ui-sref="home page">
      	{{"app.name" | translate}}
      </a>
      <a data-ng-if="globals.isAuthenticated" class="navbar-brand" data-ui-sref="todo page">
      	{{globals.authenticatedUser.username}}
      </a>
    </div>

    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-2">
      <ul class="nav navbar-nav navbar-right">
         <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="true">{{'app.language' | translate}} <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#" data-ng-click="changeLanguage('en')">{{'app.language.english' | translate}}</a></li>
            <li><a href="#" data-ng-click="changeLanguage('hi')">{{'app.language.hindi' | translate}}</a></li>
          </ul>
        </li>
      	<li data-ng-if="globals.isAuthenticated">
      		<a href="#" data-ng-click="signOut()">{{'home.signOut' | translate}}</a>
      	</li>
        <li><a data-ui-sref="about page">{{'home.about' | translate}}</a></li>
      </ul>
    </div>
  </div>
</nav>
<div class="container">
	<div class="row" data-ui-view>
			
	</div>
  <div data-ng-controller="ChatController">
    <div class="row chat-window col-xs-5 col-md-3" data-ng-repeat="chatWindow in openChatWindows">
      <div class="col-xs-12 col-md-12">
          <div class="panel panel-default">
            <div class="panel-heading top-bar">
              <div class="col-md-8 col-xs-8">
                <h3 class="panel-title">
                  <span class="glyphicon glyphicon-comment"></span> {{chatWindow.title}}
                </h3>
              </div>
              <div class="col-md-4 col-xs-4" style="text-align: right;">
                <a data-ng-click="toggleChatWindow(chatWindow)" href="#">
                  <span class="glyphicon icon_minim" data-ng-class="{'glyphicon-plus' : chatWindow.minimized, 'glyphicon-minus' : !chatWindow.minimized}"></span>
                </a>
                <a data-ng-click="closeChatWindow(chatWindow)" href="#">
                  <span class="glyphicon glyphicon-remove icon_close"></span>
                </a>
              </div>
            </div>
            <div data-ng-show="!chatWindow.minimized" class="panel-body msg_container_base">
              <div data-ng-repeat="message in chatWindow.messages">
                <div data-ng-if="globals.authenticatedUser.username == message.sender.username" class="row msg_container base_sent">
                  <div class="col-md-10 col-xs-10">
                    <div class="messages msg_sent">
                      <p data-ng-bind="message.message">
                        
                      </p>
                      <time data-ng-bind="message.time | date: 'short'"></time>
                    </div>
                  </div>
                  <div class="col-md-2 col-xs-2 avatar">
                    <img data-ng-src="{{message.sender.avatar}}" class="img-responsive"/>
                  </div>
                </div>
                <div data-ng-if="globals.authenticatedUser.username != message.sender.username" class="row msg_container base_receive">
                  <div class="col-md-2 col-xs-2 avatar">
                    <img data-ng-src="{{message.sender.avatar}}" class="img-responsive"/>
                  </div>
                  <div class="col-md-10 col-xs-10">
                    <div class="messages msg_receive">
                      <p data-ng-bind="message.message">
                      </p>
                       <time data-ng-bind="message.time | date:'short'"></time>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="panel-footer">
              <div class="input-group">
                <input ng-model="chatWindow.newMessage" to-do-enter="postMessage(chatWindow)" data-ng-focus="chatWindow.minimized && toggleChatWindow(chatWindow)" type="text" class="form-control input-lg" placeholder="Write your message here..." />
              </div>
            </div>
        </div>
      </div>
    </div>
    <!-- Online users dropup-->
    <div class="btn-group dropup">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            <span class="glyphicon glyphicon-comment"></span>
            <span class="sr-only">Toggle Dropdown</span>
        </button>
        <ul class="dropdown-menu" role="menu">
            <li data-ng-repeat="user in onlineUsers">
              <a data-ng-click="newChat(user)" href="#" data-ng-bind="user.username">
              </a>
            </li>
        </ul>
    </div>
  </div>
</div>
<script>
  var socket = io.connect('http://localhost:8080');
  socket.on('news', function (data) {
    console.log(data);
    socket.emit('my other event', { my: 'data' });
  });
</script>	
</body>
</html>